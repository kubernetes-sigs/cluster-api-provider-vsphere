---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.14.0
  name: clustervirtualmachineimages.vmoperator.vmware.com
spec:
  group: vmoperator.vmware.com
  names:
    kind: ClusterVirtualMachineImage
    listKind: ClusterVirtualMachineImageList
    plural: clustervirtualmachineimages
    shortNames:
    - cvmi
    - cvmimage
    - clustervmi
    - clustervmimage
    singular: clustervirtualmachineimage
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.imageName
      name: Display-Name
      type: string
    - jsonPath: .spec.productInfo.version
      name: Version
      type: string
    - jsonPath: .spec.osInfo.type
      name: Os-Type
      type: string
    - jsonPath: .spec.type
      name: Format
      type: string
    - jsonPath: .status.imageSupported
      name: Image-Supported
      priority: 1
      type: boolean
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: |-
          ClusterVirtualMachineImage is the schema for the clustervirtualmachineimage API
          A ClusterVirtualMachineImage represents the desired specification and the observed status of a
          ClusterVirtualMachineImage instance.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: VirtualMachineImageSpec defines the desired state of VirtualMachineImage.
            properties:
              hwVersion:
                description: HardwareVersion describes the virtual hardware version
                  of the image
                format: int32
                type: integer
              imageID:
                description: ImageID is a unique identifier exposed by the provider
                  of this VirtualMachineImage.
                type: string
              imageSourceType:
                description: |-
                  ImageSourceType describes the type of content source of the VirtualMachineImage.  The only Content Source
                  supported currently is the vSphere Content Library.
                type: string
              osInfo:
                description: |-
                  OSInfo describes the attributes of the VirtualMachineImage relating to the Operating System contained in the
                  image.
                properties:
                  type:
                    description: Type typically describes the type of the guest operating
                      system.
                    type: string
                  version:
                    description: Version typically describes the version of the guest
                      operating system.
                    type: string
                type: object
              ovfEnv:
                additionalProperties:
                  description: |-
                    OvfProperty describes information related to a user configurable property element that is supported by
                    VirtualMachineImage and can be customized during VirtualMachine creation.
                  properties:
                    default:
                      description: Default describes the default value of the ovf
                        key.
                      type: string
                    description:
                      description: |-
                        Description contains the value of the OVF property's optional
                        "Description" element.
                      type: string
                    key:
                      description: Key describes the key of the ovf property.
                      type: string
                    label:
                      description: |-
                        Label contains the value of the OVF property's optional
                        "Label" element.
                      type: string
                    type:
                      description: Type describes the type of the ovf property.
                      type: string
                  required:
                  - key
                  - type
                  type: object
                description: OVFEnv describes the user configurable customization
                  parameters of the VirtualMachineImage.
                type: object
              productInfo:
                description: |-
                  ProductInfo describes the attributes of the VirtualMachineImage relating to the product contained in the
                  image.
                properties:
                  fullVersion:
                    description: FullVersion typically describes a long-form version
                      of the image.
                    type: string
                  product:
                    description: Product typically describes the type of product contained
                      in the image.
                    type: string
                  vendor:
                    description: Vendor typically describes the name of the vendor
                      that is producing the image.
                    type: string
                  version:
                    description: Version typically describes a short-form version
                      of the image.
                    type: string
                type: object
              providerRef:
                description: ProviderRef is a reference to a content provider object
                  that describes a provider.
                properties:
                  apiVersion:
                    description: API version of the referent.
                    type: string
                  kind:
                    description: Kind is the type of resource being referenced.
                    type: string
                  name:
                    description: Name is the name of resource being referenced.
                    type: string
                  namespace:
                    description: Namespace of the resource being referenced. If empty,
                      cluster scoped resource is assumed.
                    type: string
                required:
                - kind
                - name
                type: object
              type:
                description: Type describes the type of the VirtualMachineImage. Currently,
                  the only supported image is "OVF"
                type: string
            required:
            - imageID
            - providerRef
            - type
            type: object
          status:
            description: VirtualMachineImageStatus defines the observed state of VirtualMachineImage.
            properties:
              conditions:
                description: |-
                  Conditions describes the current condition information of the VirtualMachineImage object. e.g. if the OS type
                  is supported or image is supported by VMService
                items:
                  description: Condition defines an observation of a VM Operator API
                    resource operational state.
                  properties:
                    lastTransitionTime:
                      description: |-
                        Last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed. If that is not known, then using the time when
                        the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        A human readable message indicating details about the transition.
                        This field may be empty.
                      type: string
                    reason:
                      description: |-
                        The reason for the condition's last transition in CamelCase.
                        The specific API may choose whether or not this field is considered a guaranteed API.
                        This field may not be empty.
                      type: string
                    severity:
                      description: |-
                        Severity provides an explicit classification of Reason code, so the users or machines can immediately
                        understand the current situation and act accordingly.
                        The Severity field MUST be set only when Status=False.
                      type: string
                    status:
                      description: Status of the condition, one of True, False, Unknown.
                      type: string
                    type:
                      description: |-
                        Type of condition in CamelCase or in foo.example.com/CamelCase.
                        Many .condition.type values are consistent across resources like Available, but because arbitrary conditions
                        can be useful (see .node.status.conditions), the ability to disambiguate is important.
                      type: string
                  required:
                  - status
                  - type
                  type: object
                type: array
              contentLibraryRef:
                description: |-
                  ContentLibraryRef is a reference to the source ContentLibrary/ClusterContentLibrary resource.


                  Deprecated: This field is provider specific but the VirtualMachineImage types are intended to be provider generic.
                  This field does not exist in later API versions. Instead, the Spec.ProviderRef field should be used to look up the
                  provider. For images provided by a Content Library, the ProviderRef will point to either a ContentLibraryItem or
                  ClusterContentLibraryItem that contains a reference to the Content Library.
                properties:
                  apiGroup:
                    description: |-
                      APIGroup is the group for the resource being referenced.
                      If APIGroup is not specified, the specified Kind must be in the core API group.
                      For any other third-party types, APIGroup is required.
                    type: string
                  kind:
                    description: Kind is the type of resource being referenced
                    type: string
                  name:
                    description: Name is the name of resource being referenced
                    type: string
                required:
                - kind
                - name
                type: object
                x-kubernetes-map-type: atomic
              contentVersion:
                description: |-
                  ContentVersion describes the observed content version of this VirtualMachineImage that was last successfully
                  synced with the vSphere content library item.
                type: string
              firmware:
                description: |-
                  Firmware describe the firmware type used by this VirtualMachineImage.
                  eg: bios, efi.
                type: string
              imageName:
                description: ImageName describes the display name of this image.
                type: string
              imageSupported:
                description: |-
                  ImageSupported indicates whether the VirtualMachineImage is supported by VMService.
                  A VirtualMachineImage is supported by VMService if the following conditions are true:
                  - VirtualMachineImageV1Alpha1CompatibleCondition
                type: boolean
              internalId:
                description: Deprecated
                type: string
              powerState:
                description: Deprecated
                type: string
              uuid:
                description: Deprecated
                type: string
            type: object
        type: object
    served: true
    storage: false
    subresources:
      status: {}
  - additionalPrinterColumns:
    - jsonPath: .status.name
      name: Display Name
      type: string
    - jsonPath: .status.productInfo.version
      name: Image Version
      type: string
    - jsonPath: .status.osInfo.type
      name: OS Name
      type: string
    - jsonPath: .status.osInfo.version
      name: OS Version
      type: string
    - jsonPath: .status.hardwareVersion
      name: Hardware Version
      type: string
    name: v1alpha2
    schema:
      openAPIV3Schema:
        description: |-
          ClusterVirtualMachineImage is the schema for the clustervirtualmachineimages
          API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: VirtualMachineImageSpec defines the desired state of VirtualMachineImage.
            properties:
              providerRef:
                description: |-
                  ProviderRef is a reference to the resource that contains the source of
                  this image's information.
                properties:
                  apiVersion:
                    description: |-
                      APIVersion defines the versioned schema of this representation of an
                      object. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                    type: string
                  kind:
                    description: |-
                      Kind is a string value representing the REST resource this object
                      represents.
                      Servers may infer this from the endpoint the client submits requests to.
                      Cannot be updated.
                      In CamelCase.
                      More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
                    type: string
                  name:
                    description: |-
                      Name refers to a unique resource in the current namespace.
                      More info: http://kubernetes.io/docs/user-guide/identifiers#names
                    type: string
                required:
                - apiVersion
                - kind
                - name
                type: object
            type: object
          status:
            description: VirtualMachineImageStatus defines the observed state of VirtualMachineImage.
            properties:
              capabilities:
                description: |-
                  Capabilities describes the image's observed capabilities.


                  The capabilities are discerned when VM Operator reconciles an image.
                  If the source of an image is an OVF in Content Library, then the
                  capabilities are parsed from the OVF property
                  capabilities.image.vmoperator.vmware.com as a comma-separated list of
                  values. Well-known capabilities include:


                  * cloud-init
                  * nvidia-gpu
                  * sriov-net


                  Every capability is also added to the resource's labels as
                  VirtualMachineImageCapabilityLabel + Value. For example, if the
                  capability is "cloud-init" then the following label will be added to the
                  resource: capability.image.vmoperator.vmware.com/cloud-init.
                items:
                  type: string
                type: array
                x-kubernetes-list-type: set
              conditions:
                description: Conditions describes the observed conditions for this
                  image.
                items:
                  description: "Condition contains details for one aspect of the current
                    state of this API Resource.\n---\nThis struct is intended for
                    direct use as an array at the field path .status.conditions.  For
                    example,\n\n\n\ttype FooStatus struct{\n\t    // Represents the
                    observations of a foo's current state.\n\t    // Known .status.conditions.type
                    are: \"Available\", \"Progressing\", and \"Degraded\"\n\t    //
                    +patchMergeKey=type\n\t    // +patchStrategy=merge\n\t    // +listType=map\n\t
                    \   // +listMapKey=type\n\t    Conditions []metav1.Condition `json:\"conditions,omitempty\"
                    patchStrategy:\"merge\" patchMergeKey:\"type\" protobuf:\"bytes,1,rep,name=conditions\"`\n\n\n\t
                    \   // other fields\n\t}"
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: |-
                        type of condition in CamelCase or in foo.example.com/CamelCase.
                        ---
                        Many .condition.type values are consistent across resources like Available, but because arbitrary conditions can be
                        useful (see .node.status.conditions), the ability to deconflict is important.
                        The regex it matches is (dns1123SubdomainFmt/)?(qualifiedNameFmt)
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              firmware:
                description: Firmware describe the firmware type used by this image,
                  ex. BIOS, EFI.
                type: string
              hardwareVersion:
                description: HardwareVersion describes the observed hardware version
                  of this image.
                format: int32
                type: integer
              name:
                description: Name describes the display name of this image.
                type: string
              osInfo:
                description: |-
                  OSInfo describes the observed operating system information for this
                  image.


                  The OS information is also added to the image resource's labels. Please
                  refer to VirtualMachineImageOSInfo for more information.
                properties:
                  id:
                    description: |-
                      ID describes the operating system ID.


                      This value is also added to the image resource's labels as
                      VirtualMachineImageOSIDLabel.
                    type: string
                  type:
                    description: |-
                      Type describes the operating system type.


                      This value is also added to the image resource's labels as
                      VirtualMachineImageOSTypeLabel.
                    type: string
                  version:
                    description: |-
                      Version describes the operating system version.


                      This value is also added to the image resource's labels as
                      VirtualMachineImageOSVersionLabel.
                    type: string
                type: object
              ovfProperties:
                description: |-
                  OVFProperties describes the observed user configurable OVF properties defined for this
                  image.
                items:
                  description: |-
                    OVFProperty describes an OVF property associated with an image.
                    OVF properties may be used in conjunction with the vAppConfig bootstrap
                    provider to customize a VM during its creation.
                  properties:
                    default:
                      description: Default describes the OVF property's default value.
                      type: string
                    key:
                      description: Key describes the OVF property's key.
                      type: string
                    type:
                      description: Type describes the OVF property's type.
                      type: string
                  required:
                  - key
                  - type
                  type: object
                type: array
              productInfo:
                description: ProductInfo describes the observed product information
                  for this image.
                properties:
                  fullVersion:
                    description: FullVersion describes the long-form version of the
                      image.
                    type: string
                  product:
                    description: Product is a general descriptor for the image.
                    type: string
                  vendor:
                    description: Vendor describes the organization/user that produced
                      the image.
                    type: string
                  version:
                    description: Version describes the short-form version of the image.
                    type: string
                type: object
              providerContentVersion:
                description: |-
                  ProviderContentVersion describes the content version from the provider item
                  that this image corresponds to. If the provider of this image is a Content
                  Library, this will be the version of the corresponding Content Library item.
                type: string
              providerItemID:
                description: |-
                  ProviderItemID describes the ID of the provider item that this image corresponds to.
                  If the provider of this image is a Content Library, this ID will be that of the
                  corresponding Content Library item.
                type: string
              vmwareSystemProperties:
                description: |-
                  VMwareSystemProperties describes the observed VMware system properties defined for
                  this image.
                items:
                  description: |-
                    KeyValuePair is useful when wanting to realize a map as a list of key/value
                    pairs.
                  properties:
                    key:
                      description: Key is the key part of the key/value pair.
                      type: string
                    value:
                      description: Value is the optional value part of the key/value
                        pair.
                      type: string
                  required:
                  - key
                  type: object
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
